#set($loopCounter=0)

[
#foreach($details in $context.Provisioning.taskResult.out.details)
#if(!$details.ignore || $details.ignore != "Y")
    #if($loopCounter == 0)    #set($loopCounter = 1)
    #else     ,
    #end {   #if(${details.name})   "resourceName": "${details.name}",   #else    "resourceName": null,   #end#if(${details.ipaddress})  "ipAddress": "${details.ipaddress}",   #elseif(${details.vmipaddress})  "ipAddress": "${details.vmipaddress}",   #else     "ipAddress": null,   #end"lineId": "${transaction.order_lines[0].order_line_id}" , #set( $additionalInfo = $json.getJson($details))     "additionalInfo" : $additionalInfo,   "resourceType": "${details.type}",   "externalResourceId": "${details.id}",    #if($context.Provisioning.taskResult.out.profileDetails) "profileDetails": {     "publickeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.publickeyprofileuuid",     "publickeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.publickeyprofilename",     "privatekeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.privatekeyprofilename",     "windowsprivatekeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.windowsprivatekeyprofileuuid",     "windowspublickeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.windowspublickeyprofilename",     "windowspublickeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.windowspublickeyprofileuuid",     "privatekeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.privatekeyprofileuuid",     "windowsprivatekeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.windowsprivatekeyprofilename" },   #end"vnetExternalResourceId": "${details.id}",   "subsId": "${transaction.order_lines[0].subs_id}",   "subsName": null,    #set($list = ["netapp-object-tenant", "fmc-cisco", "netapp-file-svm", "hpctera","netapp-object-grid"])   #if($list.contains($transaction.order_lines[0].order_lines[0].cloud_info.code))     "clusterMapId": "${transaction.order_lines[0].order_lines[0].cloud_info.instance_id}",   #elseif(${transaction.order_lines[0].order_lines[0].cloud_info.clusterReferenceId}) #set($myField = $transaction.order_lines[0].order_lines[0].cloud_info.clusterReferenceId) #if($myField.matches("[0-9]+"))   "clusterMapId": "${transaction.order_lines[0].order_lines[0].cloud_info.clusterReferenceId}",  #else   "clusterMapId": null, #end    #else "clusterMapId": null,   #end    #if(${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.vnetName})  "vnetName": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.vnetName}",   #else  "vnetName": null,   #end    #if(${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.clusterName}) "clusterName": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.clusterName}",   #elseif("$transaction.order_lines[0].order_lines[0].cloud_info.code" == "fmc-cisco") "clusterName": "${transaction.order_lines[0].order_lines[0].cloud_info.clusterReferenceId}",   #else  "clusterName": null,   #end"providerId": "${transaction.order_lines[0].cloud_info.providerId}"#if($context.Provisioning.taskResult.out.publickeyprofileuuid) ,"publickeyprofileuuid": "${context.Provisioning.taskResult.out.publickeyprofileuuid}"   #end#if($context.Provisioning.taskResult.out.privatekeyprofileuuid) ,"privatekeyprofileuuid": "${context.Provisioning.taskResult.out.privatekeyprofileuuid}"   #end
    }
#end
#end

#if(${transaction.order_lines[0].external_blueprint_identifier} == "management_vnet" && ${transaction.order_lines[0].provider} == "azurehci")
    #if($loopCounter == 0)     #set($loopCounter = 1)
    #else     ,
    #end    {   #if(${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.vnetName})  "resourceName": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.vnetName}",   #else  "resourceName": null,   #end   #if($context.Provisioning.taskResult.out.profileDetails) "profileDetails": {     "publickeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.publickeyprofileuuid",     "publickeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.publickeyprofilename",     "privatekeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.privatekeyprofilename",     "windowsprivatekeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.windowsprivatekeyprofileuuid",     "windowspublickeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.windowspublickeyprofilename",     "windowspublickeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.windowspublickeyprofileuuid",     "privatekeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.privatekeyprofileuuid",     "windowsprivatekeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.windowsprivatekeyprofilename" },   #end "ipAddress": null,   "lineId": "${transaction.order_lines[0].order_line_id}" , #set( $additionalInfo = $json.getJson($details))     "additionalInfo" : $additionalInfo,   "resourceType": "microsoft.azurestackhci/virtualnetworks",   "externalResourceId": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.vNetExtResId}",   "vnetExternalResourceId": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.vNetExtResId}",   "subsId": "${transaction.order_lines[0].subs_id}",   "subsName": null,    #if(${transaction.order_lines[0].order_lines[0].cloud_info.clusterReferenceId}) #set($myField = $transaction.order_lines[0].order_lines[0].cloud_info.clusterReferenceId) #if($myField.matches("[0-9]+"))"clusterMapId": "${transaction.order_lines[0].order_lines[0].cloud_info.clusterReferenceId}",  #else     "clusterMapId": null, #end   #else    "clusterMapId": null,   #end    #if(${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.vnetName})  "vnetName": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.vnetName}",   #else  "vnetName": null,   #end#if(${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.clusterName}) "clusterName": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.clusterName}",   #else  "clusterName": null,   #end"providerId": "${transaction.order_lines[0].cloud_info.providerId}"
    },{   #if(${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.subnetName})  "resourceName": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.subnetName}",   #else  "resourceName": null,   #end   #if($context.Provisioning.taskResult.out.profileDetails) "profileDetails": {     "publickeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.publickeyprofileuuid",     "publickeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.publickeyprofilename",     "privatekeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.privatekeyprofilename",     "windowsprivatekeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.windowsprivatekeyprofileuuid",     "windowspublickeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.windowspublickeyprofilename",     "windowspublickeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.windowspublickeyprofileuuid",     "privatekeyprofileuuid": "$!context.Provisioning.taskResult.out.profileDetails.privatekeyprofileuuid",     "windowsprivatekeyprofilename": "$!context.Provisioning.taskResult.out.profileDetails.windowsprivatekeyprofilename" },   #end     "ipAddress": null,   "lineId": "${transaction.order_lines[0].order_line_id}" , #set( $additionalInfo = $json.getJson($details))     "additionalInfo" : $additionalInfo,   "resourceType": "microsoft.azurestackhci/virtualsubnet",   "externalResourceId": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.subnetExternalId}",   "vnetExternalResourceId": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.subnetExternalId}",   "subsId": "${transaction.order_lines[0].subs_id}",   "subsName": null,    #if(${transaction.order_lines[0].order_lines[0].cloud_info.clusterReferenceId}) #set($myField = $transaction.order_lines[0].order_lines[0].cloud_info.clusterReferenceId) #if($myField.matches("[0-9]+"))"clusterMapId": "${transaction.order_lines[0].order_lines[0].cloud_info.clusterReferenceId}",  #else     "clusterMapId": null, #end   #else"clusterMapId": null,   #end    #if(${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.vnetName})  "vnetName": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.vnetName}",   #else  "vnetName": null,   #end#if(${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.clusterName}) "clusterName": "${transaction.order_lines[0].order_lines[0].node.configurations.config_attributes.clusterName}",   #else  "clusterName": null,   #end"providerId": "${transaction.order_lines[0].cloud_info.providerId}"
    }
#end
]
